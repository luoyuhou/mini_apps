<!--pages/order/index.wxml-->
<view class="fill-page">
    <view class="order-page">
        <view class="order-page-container">
            <!-- æ ‡é¢˜ -->
            <view class="order-page-header">
                <view class="order-page-title">ç¡®è®¤è®¢å•</view>
            </view>

            <!-- æ”¶è´§åœ°å€ -->
            <view class="address-section">
                <view class="address-card" wx:if="{{selectedAddress}}" bindtap="onSelectAddress">
                    <view class="address-icon">ğŸ“</view>
                    <view class="address-content">
                        <view class="address-user">
                            <text class="user-name">{{selectedAddress.recipient}}</text>
                            <text class="user-phone">{{selectedAddress.phone}}</text>
                        </view>
                        <view class="address-detail">{{selectedAddress.address}}</view>
                    </view>
                    <view class="address-arrow">â€º</view>
                </view>
                
                <view class="address-empty" wx:if="{{!selectedAddress}}" bindtap="onSelectAddress">
                    <text class="empty-icon">+</text>
                    <text class="empty-text">æ·»åŠ æ”¶è´§åœ°å€</text>
                </view>
            </view>

            <!-- é€è¾¾æ—¶é—´ -->
            <view class="delivery-section">
                <view class="delivery-card" wx:if="{{deliveryTime}}" bindtap="onSelectDeliveryTime">
                    <view class="delivery-icon">ğŸ•</view>
                    <view class="delivery-content">
                        <view class="delivery-label">é€è¾¾æ—¶é—´</view>
                        <view class="delivery-time">
                            <text class="time-label">{{deliveryTime.label}}</text>
                            <text class="time-desc">{{deliveryTime.description}}</text>
                        </view>
                    </view>
                    <view class="delivery-arrow">â€º</view>
                </view>
                
                <view class="delivery-empty" wx:if="{{!deliveryTime}}" bindtap="onSelectDeliveryTime">
                    <text class="empty-icon">ğŸ•</text>
                    <text class="empty-text">é€‰æ‹©é€è¾¾æ—¶é—´</text>
                </view>
            </view>

            <!-- è´­ç‰©è½¦å•†å“åˆ—è¡¨ -->
            <view class="order-page-list" wx:if="{{cartItems.length > 0}}">
                <view class="order-item" wx:for="{{cartItems}}" wx:key="version_id">
                    <view class="item-info">
                        <view class="item-name">{{item.goods_name}}</view>
                        <view class="item-spec">è§„æ ¼: {{item.unit_name}}</view>
                        <view class="item-price">Â¥{{item.price / 100}}</view>
                    </view>
                    <view class="item-controls">
                        <view class="quantity-control">
                            <button class="btn-decrease" bindtap="onDecreaseCount" data-index="{{index}}">-</button>
                            <input 
                                class="input-count" 
                                type="digit" 
                                value="{{item.count}}" 
                                bindconfirm="onInputCount" 
                                data-index="{{index}}"
                            />
                            <button class="btn-increase" bindtap="onIncreaseCount" data-index="{{index}}">+</button>
                        </view>
                        <view class="item-subtotal">å°è®¡: Â¥{{item.subtotal / 100}}</view>
                    </view>
                </view>
            </view>

            <!-- ç©ºè´­ç‰©è½¦æç¤º -->
            <view class="empty-cart" wx:if="{{cartItems.length === 0}}">
                <text class="empty-text">è´­ç‰©è½¦ä¸ºç©º</text>
                <text class="empty-hint">å»é€‰è´­å•†å“å§ï½</text>
            </view>

            <!-- åº•éƒ¨ç»“ç®—æ  -->
            <view class="order-page-footer" wx:if="{{cartItems.length > 0}}">
                <view class="order-summary">
                    <view class="summary-row">
                        <text class="summary-label">å•†å“æ•°é‡:</text>
                        <text class="summary-value">{{totalCount}} ä»¶</text>
                    </view>
                    <view class="summary-row total-row">
                        <text class="summary-label">æ€»è®¡:</text>
                        <text class="summary-total">Â¥{{(totalPrice / 100)}}</text>
                    </view>
                </view>
                <view class="order-submit">
                    <button class="btn-submit" type="primary" bindtap="onOrder">ç«‹å³ä¸‹å•</button>
                </view>
            </view>
        </view>
    </view>
</view>

