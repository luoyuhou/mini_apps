<!--pages/me/index.wxml-->
<view class="me--page">
  <!-- 用户信息卡片 -->
  <view class="me--header">
    <view class="user-info">
      <!-- 头像选择器 -->
      <button class="avatar-wrapper" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
        <image class="user-avatar" src="{{profile.avatarUrl || profile.avatar || '../../static/img/profile.png'}}" mode="aspectFill"></image>
      </button>
      <view class="user-detail">
        <!-- 昵称输入框 -->
        <input 
          class="user-name-input" 
          type="nickname" 
          placeholder="点击设置昵称"
          value="{{profile.nickName || profile.nickname || ''}}"
          bind:blur="onNicknameBlur"
        />
        <view class="user-level">
          <text class="level-badge">会员</text>
          <text class="user-phone">{{profile.phone || '未绑定手机'}}</text>
        </view>
      </view>
      <view class="user-vip" bindtap="onVipClick">
        <text>开通会员 ></text>
      </view>
    </view>
    
    <!-- 数据统计 -->
    <view class="user-stats">
      <view class="stat-item" bindtap="onNavToFavorites">
        <image class="menu-icon" src="../../static/img/collect.png" mode="aspectFit"></image>
        <text class="stat-label">收藏</text>
      </view>
      <view class="stat-item" bindtap="onNavToHistory">
        <image class="menu-icon" src="../../static/img/foot.png" mode="aspectFit"></image>
        <text class="stat-label">浏览记录</text>
      </view>
    </view>
  </view>

  <!-- 我的订单 -->
  <view class="me--section">
    <view class="section-title">
      <text class="title-text">我的订单</text>
      <navigator url="../order-list/order-list" class="title-more">
        <text>查看全部</text>
        <image class="arrow-icon" src="../../static/img/chevron_right.png" mode="aspectFit"></image>
      </navigator>
    </view>
    <view class="order-menu">
      <view class="menu-item" bindtap="onNavToOrders" data-status="0">
        <image class="menu-icon" src="../../static/img/cart.png" mode="aspectFit"></image>
        <text class="menu-text">待付款</text>
      </view>
      <view class="menu-item" bindtap="onNavToOrders" data-status="1">
        <image class="menu-icon" src="../../static/img/home.png" mode="aspectFit"></image>
        <text class="menu-text">待发货</text>
      </view>
      <view class="menu-item" bindtap="onNavToOrders" data-status="2">
        <image class="menu-icon" src="../../static/img/cart.png" mode="aspectFit"></image>
        <text class="menu-text">待收货</text>
      </view>
      <view class="menu-item" bindtap="onNavToOrders" data-status="4">
        <image class="menu-icon" src="../../static/img/star.png" mode="aspectFit"></image>
        <text class="menu-text">待评价</text>
      </view>
      <view class="menu-item" bindtap="onNavToRefund">
        <image class="menu-icon" src="../../static/img/home.png" mode="aspectFit"></image>
        <text class="menu-text">退款/售后</text>
      </view>
    </view>
  </view>

  <!-- 钱包 -->
  <view class="me--section">
    <view class="section-title">
      <text class="title-text">我的钱包</text>
    </view>
    <view class="wallet-menu">
      <view class="wallet-item">
        <view class="wallet-left">
          <image class="wallet-icon" src="../../static/img/cart.png" mode="aspectFit"></image>
          <text class="wallet-text">余额</text>
        </view>
        <view class="wallet-right">
          <text class="wallet-amount">¥{{profile.money || '0.00'}}</text>
        </view>
      </view>
      <view class="wallet-item">
        <view class="wallet-left">
          <image class="wallet-icon" src="../../static/img/star.png" mode="aspectFit"></image>
          <text class="wallet-text">优惠券</text>
        </view>
        <view class="wallet-right">
          <text class="wallet-count">0张</text>
          <image class="arrow-icon" src="../../static/img/chevron_right.png" mode="aspectFit"></image>
        </view>
      </view>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="me--section">
    <view class="function-menu">
      <navigator url="../address/index/index" class="function-item">
        <view class="function-icon-wrap">
          <view class="location-icon-outline"></view>
        </view>
        <text class="function-text">收货地址</text>
        <image class="arrow-icon" src="../../static/img/chevron_right.png" mode="aspectFit"></image>
      </navigator>
      <navigator url="../chat/index" class="function-item">
        <image class="function-icon" src="../../static/img/wechat-line.png" mode="aspectFit"></image>
        <text class="function-text">在线客服</text>
        <image class="arrow-icon" src="../../static/img/chevron_right.png" mode="aspectFit"></image>
      </navigator>
      <view class="function-item">
        <image class="function-icon" src="../../static/img/home.png" mode="aspectFit"></image>
        <text class="function-text">关于我们</text>
        <image class="arrow-icon" src="../../static/img/chevron_right.png" mode="aspectFit"></image>
      </view>
    </view>
  </view>
</view>
